FROM golang:1.23

ARG WEB_SERVER_PORT
ARG GRPC_SERVER_PORT
ARG GRAPHQL_SERVER_PORT

ENV WEB_SERVER_PORT=${WEB_SERVER_PORT}
ENV GRPC_SERVER_PORT=${GRPC_SERVER_PORT}
ENV GRAPHQL_SERVER_PORT=${GRAPHQL_SERVER_PORT}

WORKDIR /app

RUN go install github.com/air-verse/air@latest

COPY go.mod go.sum ./
RUN go mod download

EXPOSE ${WEB_SERVER_PORT}
EXPOSE ${GRPC_SERVER_PORT}
EXPOSE ${GRAPHQL_SERVER_PORT}

CMD ["air", "-c", "air.toml"]
